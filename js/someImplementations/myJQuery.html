<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .box {
            color: red;
            font-size: 20px;
        }
    </style>
</head>
<body>
    <!--  自己实现了很小很小一部分的jQuery
            不完全一样 (^-^) -->
    <div class="box">1</div>
    <div class="box">2</div>
    <div class="box">3</div>
</body>
<script>
    (function(window) {
        function jQuery(selector) {
            return new jQuery.prototype.init(selector)
        }

        jQuery.prototype = {
            constructor: jQuery,
            init: function(selector) {
                let doms = document.querySelectorAll(selector)
                for(let i = 0; i < doms.length; i++) {
                    this[i] = doms[i]
                }
                this.length = doms.length

                return this
            }
        }

        jQuery.prototype.init.prototype = jQuery.prototype

        jQuery.extend = jQuery.prototype.extend = function(...args) {
            var target, source = [...args];
            if(args.length === 1) {
                target = this
            }
            else {
                target = source[0]
                source.splice(0, 1)
            }
            Object.assign(target, ...source)
            return target
        }

        jQuery.extend({
            each(obj, callback) {
                // 1. 数组和伪数组用for循环
                //  --> 拥有length属性且length不小于0
                // 2. 对象用for。。in
                if( (length in obj) && obj.length >= 0) {
                    for(let i = 0; i < obj.length; i++) {
                        callback.call(obj[i], i, obj[i])
                    }
                }
                else {
                    for(var key in obj) {
                        callback.call(obj[key], key, obj[key])
                    }
                }
            },
            type(obj) {
                return Object.prototype.toString.call(obj)
                    .replace("[object ", "")
                    .replace("]","")
                    .toLowerCase()
            }
        })

        jQuery.prototype.extend({
            each(callback) {
                jQuery.each(this, callback)
            },
            css(...args) {
                // 传一个参数
                // 1. 获取样式
                // 2. 设置多个样式
                if(args.length === 1) {
                    if(jQuery.type(args[0]) === "string") {
                        return window.getComputedStyle(this[0])[args[0]]
                    }
                    else {
                        return jQuery.each(args[0],(key, value) => {
                            this.css(key, value)
                        })
                    }
                }
                else {
                    this.each(function(key, dom) {
                        this.style[args[0]] = args[1]
                    })
                }
            }
        })

        window.jQuery = window.$ = jQuery
    })(window)

    // jQuery.each( {fontSize:"18px", color: "blue"}, function(index, item) {
    //     console.log(index, item)
    // })
    console.log(jQuery.type(""))
    $(".box").css({ fontSize:"18px", color: "green"})
</script>
</html>